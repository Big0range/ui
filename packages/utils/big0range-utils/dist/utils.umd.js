(function(L,R){typeof exports=="object"&&typeof module<"u"?R(exports):typeof define=="function"&&define.amd?define(["exports"],R):(L=typeof globalThis<"u"?globalThis:L||self,R(L.utils={}))})(this,function(L){"use strict";const R=s=>(s.install=i=>{const a=s.name||s.__name;i.component(a,s)},s);let tt={},it=Object.getPrototypeOf,at=tt.toString,et=tt.hasOwnProperty,nt=et.toString,st=nt.call(Object);const ut=s=>{let i,a;return!s||at.call(s)!=="[object Object]"?!1:(i=it(s),i?(a=et.call(i,"constructor")&&i.constructor,typeof a=="function"&&nt.call(a)===st):!0)},ct={set(s,i){window.localStorage.setItem(s,JSON.stringify(i))},get(s){const i=window.localStorage.getItem(s);return JSON.parse(i)},remove(s){window.localStorage.removeItem(s)},clear(){window.localStorage.clear()}},ft={set(s,i){window.sessionStorage.setItem(s,JSON.stringify(i))},get(s){const i=window.sessionStorage.getItem(s);return JSON.parse(i)},remove(s){window.sessionStorage.removeItem(s)},clear(){window.sessionStorage.clear()}};function lt(s,i="rgba(17, 17, 17, 0.2)"){rt();const a=document.createElement("canvas");a.id="watermark-canvas",document.body.appendChild(a),a.width=165,a.height=95,a.style.display="none";const f=a.getContext("2d");f.rotate(-20*Math.PI/180),f.font="16px Microsoft JhengHei",f.fillStyle=i,f.textAlign="left",f.textBaseline="middle",f.fillText(s,30,105,200);const u=document.createElement("div");u.id="watermark-div",u.style.backgroundImage="url("+a.toDataURL("image/png")+")",u.style.position="fixed",u.style.zIndex="99999999999",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.pointerEvents="none",document.body.appendChild(u),document.body.removeChild(a)}function rt(){document.getElementById("watermark-div")&&document.body.removeChild(document.getElementById("watermark-div"))}const dt={set:lt,clear:rt};function ht(s,i){const a=new FileReader;a.readAsDataURL(s),a.onload=function(f){var S;const u=document.createElement("a");u.download=i,u.href=(S=f.target)==null?void 0:S.result,document.body.appendChild(u),u.click(),document.body.removeChild(u),console.log("123")}}function gt(s,i){const a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){const f=document.createElement("canvas");f.width=a.width,f.height=a.height,f.getContext("2d").drawImage(a,0,0,a.width,a.height);const S=f.toDataURL("image/png"),C=document.createElement("a"),z=new MouseEvent("click");C.download=i,C.href=S,C.dispatchEvent(z)},a.src=s}if(!N)var N={map:function(i,a){var f={};return a?i.map(function(u,S){return f.index=S,a.call(f,u)}):i.slice()},naturalOrder:function(i,a){return i<a?-1:i>a?1:0},sum:function(i,a){var f={};return i.reduce(a?function(u,S,C){return f.index=C,u+a.call(f,S)}:function(u,S){return u+S},0)},max:function(i,a){return Math.max.apply(null,a?N.map(i,a):i)}};var mt=function(){var s=5,i=8-s,a=1e3,f=.75;function u(M,t,e){return(M<<2*s)+(t<<s)+e}function S(M){var t=[],e=!1;function p(){t.sort(M),e=!0}return{push:function(m){t.push(m),e=!1},peek:function(m){return e||p(),m===void 0&&(m=t.length-1),t[m]},pop:function(){return e||p(),t.pop()},size:function(){return t.length},map:function(m){return t.map(m)},debug:function(){return e||p(),t}}}function C(M,t,e,p,w,m,v){var y=this;y.r1=M,y.r2=t,y.g1=e,y.g2=p,y.b1=w,y.b2=m,y.histo=v}C.prototype={volume:function(t){var e=this;return(!e._volume||t)&&(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(t){var e=this,p=e.histo;if(!e._count_set||t){var w=0,m,v,y,_;for(m=e.r1;m<=e.r2;m++)for(v=e.g1;v<=e.g2;v++)for(y=e.b1;y<=e.b2;y++)_=u(m,v,y),w+=p[_]||0;e._count=w,e._count_set=!0}return e._count},copy:function(){var t=this;return new C(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(t){var e=this,p=e.histo;if(!e._avg||t){var w=0,m=1<<8-s,v=0,y=0,_=0,l,$,D,T,O;for($=e.r1;$<=e.r2;$++)for(D=e.g1;D<=e.g2;D++)for(T=e.b1;T<=e.b2;T++)O=u($,D,T),l=p[O]||0,w+=l,v+=l*($+.5)*m,y+=l*(D+.5)*m,_+=l*(T+.5)*m;w?e._avg=[~~(v/w),~~(y/w),~~(_/w)]:e._avg=[~~(m*(e.r1+e.r2+1)/2),~~(m*(e.g1+e.g2+1)/2),~~(m*(e.b1+e.b2+1)/2)]}return e._avg},contains:function(t){var e=this,p=t[0]>>i;return gval=t[1]>>i,bval=t[2]>>i,p>=e.r1&&p<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}};function z(){this.vboxes=new S(function(M,t){return N.naturalOrder(M.vbox.count()*M.vbox.volume(),t.vbox.count()*t.vbox.volume())})}z.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,p=0;p<e.size();p++)if(e.peek(p).vbox.contains(t))return e.peek(p).color;return this.nearest(t)},nearest:function(t){for(var e=this.vboxes,p,w,m,v=0;v<e.size();v++)w=Math.sqrt(Math.pow(t[0]-e.peek(v).color[0],2)+Math.pow(t[1]-e.peek(v).color[1],2)+Math.pow(t[2]-e.peek(v).color[2],2)),(w<p||p===void 0)&&(p=w,m=e.peek(v).color);return m},forcebw:function(){var t=this.vboxes;t.sort(function(m,v){return N.naturalOrder(N.sum(m.color),N.sum(v.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var p=t.length-1,w=t[p].color;w[0]>251&&w[1]>251&&w[2]>251&&(t[p].color=[255,255,255])}};function k(M){var t=1<<3*s,e=new Array(t),p,w,m,v;return M.forEach(function(y){w=y[0]>>i,m=y[1]>>i,v=y[2]>>i,p=u(w,m,v),e[p]=(e[p]||0)+1}),e}function A(M,t){var e=1e6,p=0,w=1e6,m=0,v=1e6,y=0,_,l,$;return M.forEach(function(D){_=D[0]>>i,l=D[1]>>i,$=D[2]>>i,_<e?e=_:_>p&&(p=_),l<w?w=l:l>m&&(m=l),$<v?v=$:$>y&&(y=$)}),new C(e,p,w,m,v,y,t)}function q(M,t){if(!t.count())return;var e=t.r2-t.r1+1,p=t.g2-t.g1+1,w=t.b2-t.b1+1,m=N.max([e,p,w]);if(t.count()==1)return[t.copy()];var v=0,y=[],_=[],l,$,D,T,O;if(m==e)for(l=t.r1;l<=t.r2;l++){for(T=0,$=t.g1;$<=t.g2;$++)for(D=t.b1;D<=t.b2;D++)O=u(l,$,D),T+=M[O]||0;v+=T,y[l]=v}else if(m==p)for(l=t.g1;l<=t.g2;l++){for(T=0,$=t.r1;$<=t.r2;$++)for(D=t.b1;D<=t.b2;D++)O=u($,l,D),T+=M[O]||0;v+=T,y[l]=v}else for(l=t.b1;l<=t.b2;l++){for(T=0,$=t.r1;$<=t.r2;$++)for(D=t.g1;D<=t.g2;D++)O=u($,D,l),T+=M[O]||0;v+=T,y[l]=v}y.forEach(function(j,F){_[F]=v-j});function b(j){var F=j+"1",d=j+"2",o,n,h,r,c,g=0;for(l=t[F];l<=t[d];l++)if(y[l]>v/2){for(h=t.copy(),r=t.copy(),o=l-t[F],n=t[d]-l,o<=n?c=Math.min(t[d]-1,~~(l+n/2)):c=Math.max(t[F],~~(l-1-o/2));!y[c];)c++;for(g=_[c];!g&&y[c-1];)g=_[--c];return h[d]=c,r[F]=h[d]+1,[h,r]}}return m==e?b("r"):m==p?b("g"):b("b")}function Y(M,t){if(!M.length||t<2||t>256)return!1;var e=k(M);e.forEach(function(){});var p=A(M,e),w=new S(function(_,l){return N.naturalOrder(_.count(),l.count())});w.push(p);function m(_,l){for(var $=_.size(),D=0,T;D<a;){if($>=l||D++>a)return;if(T=_.pop(),!T.count()){_.push(T),D++;continue}var O=q(e,T),b=O[0],j=O[1];if(!b)return;_.push(b),j&&(_.push(j),$++)}}m(w,f*t);for(var v=new S(function(_,l){return N.naturalOrder(_.count()*_.volume(),l.count()*l.volume())});w.size();)v.push(w.pop());m(v,t);for(var y=new z;v.size();)y.push(v.pop());return y}return{quantize:Y}}(),pt=mt.quantize;function vt(s,i,a){const f=s,u=[];for(let S=0,C,z,k,A,q;S<i;S=S+a)C=S*4,z=f[C+0],k=f[C+1],A=f[C+2],q=f[C+3],(typeof q>"u"||q>=125)&&(z>250&&k>250&&A>250||u.push([z,k,A]));return u}function wt(s){let{colorCount:i,quality:a}=s;if(typeof i>"u"||!Number.isInteger(i))i=10;else{if(i===1)throw new Error("colorCount应该在2到20之间。要获得一种颜色, 调用getColor()而不是getPalette()");i=Math.max(i,2),i=Math.min(i,20)}return(typeof a>"u"||!Number.isInteger(a)||a<1)&&(a=10),{colorCount:i,quality:a}}const ot={createPixelArray:vt,validateOptions:wt};function yt(s){s.setAttribute("crossOrigin","anonymous");const i=document.createElement("canvas"),a=i.getContext("2d"),f=i.width=s.width,u=i.height=s.height;return a.drawImage(s,0,0,f,u),{canvas:i,context:a,width:f,height:u,getImageData:()=>a.getImageData(0,0,f,u)}}function $t(s,i=10){return G(s,5,i)[0]}function G(s,i=8,a=10){s.setAttribute("crossOrigin","anonymous");const f=ot.validateOptions({colorCount:i,quality:a}),u=yt(s),S=u.getImageData(),C=u.width*u.height,z=ot.createPixelArray(S.data,C,f.quality),k=pt(z,f.colorCount);return k?k.palette():[]}function Mt(s,i){return new Promise((a,f)=>{const u=document.createElement("img");u.setAttribute("crossOrigin","anonymous"),u.addEventListener("load",()=>{const S=G(u,5,i),C=S?S[0]:[];a(C)}),u.addEventListener("error",()=>{f()}),u.src=s})}function bt(s){return new Promise((i,a)=>{let f=new XMLHttpRequest;f.open("GET",s,!0),f.responseType="arraybuffer",f.onload=function(){if(this.status==200){let u=new Uint8Array(this.response),S=u.length,C=new Array(S);for(let A=0;A<u.length;A++)C[A]=String.fromCharCode(u[A]);let z=C.join(""),k=window.btoa(z);i("data:image/png;base64,"+k)}},f.onerror=a,f.send()})}const St={getPalette:G,getColorFromUrl:Mt,getImageData:bt,getColor:$t};var Ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},X={},Dt={get exports(){return X},set exports(s){X=s}};(function(s,i){(function(a,f){s.exports=f()})(Ot,function(){var a=1e3,f=6e4,u=36e5,S="millisecond",C="second",z="minute",k="hour",A="day",q="week",Y="month",M="quarter",t="year",e="date",p="Invalid Date",w=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(d){var o=["th","st","nd","rd"],n=d%100;return"["+d+(o[(n-20)%10]||o[n]||o[0])+"]"}},y=function(d,o,n){var h=String(d);return!h||h.length>=o?d:""+Array(o+1-h.length).join(n)+d},_={s:y,z:function(d){var o=-d.utcOffset(),n=Math.abs(o),h=Math.floor(n/60),r=n%60;return(o<=0?"+":"-")+y(h,2,"0")+":"+y(r,2,"0")},m:function d(o,n){if(o.date()<n.date())return-d(n,o);var h=12*(n.year()-o.year())+(n.month()-o.month()),r=o.clone().add(h,Y),c=n-r<0,g=o.clone().add(h+(c?-1:1),Y);return+(-(h+(n-r)/(c?r-g:g-r))||0)},a:function(d){return d<0?Math.ceil(d)||0:Math.floor(d)},p:function(d){return{M:Y,y:t,w:q,d:A,D:e,h:k,m:z,s:C,ms:S,Q:M}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(d){return d===void 0}},l="en",$={};$[l]=v;var D=function(d){return d instanceof j},T=function d(o,n,h){var r;if(!o)return l;if(typeof o=="string"){var c=o.toLowerCase();$[c]&&(r=c),n&&($[c]=n,r=c);var g=o.split("-");if(!r&&g.length>1)return d(g[0])}else{var I=o.name;$[I]=o,r=I}return!h&&r&&(l=r),r||!h&&l},O=function(d,o){if(D(d))return d.clone();var n=typeof o=="object"?o:{};return n.date=d,n.args=arguments,new j(n)},b=_;b.l=T,b.i=D,b.w=function(d,o){return O(d,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var j=function(){function d(n){this.$L=T(n.locale,null,!0),this.parse(n)}var o=d.prototype;return o.parse=function(n){this.$d=function(h){var r=h.date,c=h.utc;if(r===null)return new Date(NaN);if(b.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var g=r.match(w);if(g){var I=g[2]-1||0,E=(g[7]||"0").substring(0,3);return c?new Date(Date.UTC(g[1],I,g[3]||1,g[4]||0,g[5]||0,g[6]||0,E)):new Date(g[1],I,g[3]||1,g[4]||0,g[5]||0,g[6]||0,E)}}return new Date(r)}(n),this.$x=n.x||{},this.init()},o.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},o.$utils=function(){return b},o.isValid=function(){return this.$d.toString()!==p},o.isSame=function(n,h){var r=O(n);return this.startOf(h)<=r&&r<=this.endOf(h)},o.isAfter=function(n,h){return O(n)<this.startOf(h)},o.isBefore=function(n,h){return this.endOf(h)<O(n)},o.$g=function(n,h,r){return b.u(n)?this[h]:this.set(r,n)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(n,h){var r=this,c=!!b.u(h)||h,g=b.p(n),I=function(B,P){var W=b.w(r.$u?Date.UTC(r.$y,P,B):new Date(r.$y,P,B),r);return c?W:W.endOf(A)},E=function(B,P){return b.w(r.toDate()[B].apply(r.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(P)),r)},x=this.$W,H=this.$M,J=this.$D,U="set"+(this.$u?"UTC":"");switch(g){case t:return c?I(1,0):I(31,11);case Y:return c?I(1,H):I(0,H+1);case q:var V=this.$locale().weekStart||0,Z=(x<V?x+7:x)-V;return I(c?J-Z:J+(6-Z),H);case A:case e:return E(U+"Hours",0);case k:return E(U+"Minutes",1);case z:return E(U+"Seconds",2);case C:return E(U+"Milliseconds",3);default:return this.clone()}},o.endOf=function(n){return this.startOf(n,!1)},o.$set=function(n,h){var r,c=b.p(n),g="set"+(this.$u?"UTC":""),I=(r={},r[A]=g+"Date",r[e]=g+"Date",r[Y]=g+"Month",r[t]=g+"FullYear",r[k]=g+"Hours",r[z]=g+"Minutes",r[C]=g+"Seconds",r[S]=g+"Milliseconds",r)[c],E=c===A?this.$D+(h-this.$W):h;if(c===Y||c===t){var x=this.clone().set(e,1);x.$d[I](E),x.init(),this.$d=x.set(e,Math.min(this.$D,x.daysInMonth())).$d}else I&&this.$d[I](E);return this.init(),this},o.set=function(n,h){return this.clone().$set(n,h)},o.get=function(n){return this[b.p(n)]()},o.add=function(n,h){var r,c=this;n=Number(n);var g=b.p(h),I=function(H){var J=O(c);return b.w(J.date(J.date()+Math.round(H*n)),c)};if(g===Y)return this.set(Y,this.$M+n);if(g===t)return this.set(t,this.$y+n);if(g===A)return I(1);if(g===q)return I(7);var E=(r={},r[z]=f,r[k]=u,r[C]=a,r)[g]||1,x=this.$d.getTime()+n*E;return b.w(x,this)},o.subtract=function(n,h){return this.add(-1*n,h)},o.format=function(n){var h=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var c=n||"YYYY-MM-DDTHH:mm:ssZ",g=b.z(this),I=this.$H,E=this.$m,x=this.$M,H=r.weekdays,J=r.months,U=function(P,W,K,Q){return P&&(P[W]||P(h,c))||K[W].slice(0,Q)},V=function(P){return b.s(I%12||12,P,"0")},Z=r.meridiem||function(P,W,K){var Q=P<12?"AM":"PM";return K?Q.toLowerCase():Q},B={YY:String(this.$y).slice(-2),YYYY:this.$y,M:x+1,MM:b.s(x+1,2,"0"),MMM:U(r.monthsShort,x,J,3),MMMM:U(J,x),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:U(r.weekdaysMin,this.$W,H,2),ddd:U(r.weekdaysShort,this.$W,H,3),dddd:H[this.$W],H:String(I),HH:b.s(I,2,"0"),h:V(1),hh:V(2),a:Z(I,E,!0),A:Z(I,E,!1),m:String(E),mm:b.s(E,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:g};return c.replace(m,function(P,W){return W||B[P]||g.replace(":","")})},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(n,h,r){var c,g=b.p(h),I=O(n),E=(I.utcOffset()-this.utcOffset())*f,x=this-I,H=b.m(this,I);return H=(c={},c[t]=H/12,c[Y]=H,c[M]=H/3,c[q]=(x-E)/6048e5,c[A]=(x-E)/864e5,c[k]=x/u,c[z]=x/f,c[C]=x/a,c)[g]||x,r?H:b.a(H)},o.daysInMonth=function(){return this.endOf(Y).$D},o.$locale=function(){return $[this.$L]},o.locale=function(n,h){if(!n)return this.$L;var r=this.clone(),c=T(n,h,!0);return c&&(r.$L=c),r},o.clone=function(){return b.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},d}(),F=j.prototype;return O.prototype=F,[["$ms",S],["$s",C],["$m",z],["$H",k],["$W",A],["$M",Y],["$y",t],["$D",e]].forEach(function(d){F[d[1]]=function(o){return this.$g(o,d[0],d[1])}}),O.extend=function(d,o){return d.$i||(d(o,j,O),d.$i=!0),O},O.locale=T,O.isDayjs=D,O.unix=function(d){return O(1e3*d)},O.en=$[l],O.Ls=$,O.p={},O})})(Dt);const Ct=X;L.ColorThief=St,L.dayjs=Ct,L.downloadFile=ht,L.downloadImg=gt,L.isObject=ut,L.localStorage=ct,L.sessionStorage=ft,L.waterMark=dt,L.withInstall=R,Object.defineProperty(L,Symbol.toStringTag,{value:"Module"})});
