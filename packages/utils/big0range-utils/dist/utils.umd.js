(function(P,R){typeof exports=="object"&&typeof module<"u"?R(exports):typeof define=="function"&&define.amd?define(["exports"],R):(P=typeof globalThis<"u"?globalThis:P||self,R(P.utils={}))})(this,function(P){"use strict";const R=s=>(s.install=r=>{const i=s.name||s.__name;r.component(i,s)},s);let et={},at=Object.getPrototypeOf,st=et.toString,nt=et.hasOwnProperty,rt=nt.toString,ut=rt.call(Object);const ct=s=>{let r,i;return!s||st.call(s)!=="[object Object]"?!1:(r=at(s),r?(i=nt.call(r,"constructor")&&r.constructor,typeof i=="function"&&rt.call(i)===ut):!0)},ft={set(s,r){window.localStorage.setItem(s,JSON.stringify(r))},get(s){const r=window.localStorage.getItem(s);return JSON.parse(r)},remove(s){window.localStorage.removeItem(s)},clear(){window.localStorage.clear()}},lt={set(s,r){window.sessionStorage.setItem(s,JSON.stringify(r))},get(s){const r=window.sessionStorage.getItem(s);return JSON.parse(r)},remove(s){window.sessionStorage.removeItem(s)},clear(){window.sessionStorage.clear()}};function dt(s,r="rgba(17, 17, 17, 0.2)"){ot();const i=document.createElement("canvas");i.id="watermark-canvas",document.body.appendChild(i),i.width=165,i.height=95,i.style.display="none";const f=i.getContext("2d");f.rotate(-20*Math.PI/180),f.font="16px Microsoft JhengHei",f.fillStyle=r,f.textAlign="left",f.textBaseline="middle",f.fillText(s,30,105,200);const u=document.createElement("div");u.id="watermark-div",u.style.backgroundImage="url("+i.toDataURL("image/png")+")",u.style.position="fixed",u.style.zIndex="99999999999",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.pointerEvents="none",document.body.appendChild(u),document.body.removeChild(i)}function ot(){document.getElementById("watermark-div")&&document.body.removeChild(document.getElementById("watermark-div"))}const ht={set:dt,clear:ot};function gt(s,r){const i=new FileReader;i.readAsDataURL(s),i.onload=function(f){var S;const u=document.createElement("a");u.download=r,u.href=(S=f.target)==null?void 0:S.result,document.body.appendChild(u),u.click(),document.body.removeChild(u),console.log("123")}}function mt(s,r){const i=new Image;i.setAttribute("crossOrigin","anonymous"),i.onload=function(){const f=document.createElement("canvas");f.width=i.width,f.height=i.height,f.getContext("2d").drawImage(i,0,0,i.width,i.height);const S=f.toDataURL("image/png"),_=document.createElement("a"),E=new MouseEvent("click");_.download=r,_.href=S,_.dispatchEvent(E)},i.src=s}if(!q)var q={map:function(r,i){var f={};return i?r.map(function(u,S){return f.index=S,i.call(f,u)}):r.slice()},naturalOrder:function(r,i){return r<i?-1:r>i?1:0},sum:function(r,i){var f={};return r.reduce(i?function(u,S,_){return f.index=_,u+i.call(f,S)}:function(u,S){return u+S},0)},max:function(r,i){return Math.max.apply(null,i?q.map(r,i):r)}};var pt=function(){var s=5,r=8-s,i=1e3,f=.75;function u(M,t,e){return(M<<2*s)+(t<<s)+e}function S(M){var t=[],e=!1;function p(){t.sort(M),e=!0}return{push:function(m){t.push(m),e=!1},peek:function(m){return e||p(),m===void 0&&(m=t.length-1),t[m]},pop:function(){return e||p(),t.pop()},size:function(){return t.length},map:function(m){return t.map(m)},debug:function(){return e||p(),t}}}function _(M,t,e,p,y,m,v){var w=this;w.r1=M,w.r2=t,w.g1=e,w.g2=p,w.b1=y,w.b2=m,w.histo=v}_.prototype={volume:function(t){var e=this;return(!e._volume||t)&&(e._volume=(e.r2-e.r1+1)*(e.g2-e.g1+1)*(e.b2-e.b1+1)),e._volume},count:function(t){var e=this,p=e.histo;if(!e._count_set||t){var y=0,m,v,w,C;for(m=e.r1;m<=e.r2;m++)for(v=e.g1;v<=e.g2;v++)for(w=e.b1;w<=e.b2;w++)C=u(m,v,w),y+=p[C]||0;e._count=y,e._count_set=!0}return e._count},copy:function(){var t=this;return new _(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(t){var e=this,p=e.histo;if(!e._avg||t){var y=0,m=1<<8-s,v=0,w=0,C=0,l,$,O,T,D;for($=e.r1;$<=e.r2;$++)for(O=e.g1;O<=e.g2;O++)for(T=e.b1;T<=e.b2;T++)D=u($,O,T),l=p[D]||0,y+=l,v+=l*($+.5)*m,w+=l*(O+.5)*m,C+=l*(T+.5)*m;y?e._avg=[~~(v/y),~~(w/y),~~(C/y)]:e._avg=[~~(m*(e.r1+e.r2+1)/2),~~(m*(e.g1+e.g2+1)/2),~~(m*(e.b1+e.b2+1)/2)]}return e._avg},contains:function(t){var e=this,p=t[0]>>r;return gval=t[1]>>r,bval=t[2]>>r,p>=e.r1&&p<=e.r2&&gval>=e.g1&&gval<=e.g2&&bval>=e.b1&&bval<=e.b2}};function E(){this.vboxes=new S(function(M,t){return q.naturalOrder(M.vbox.count()*M.vbox.volume(),t.vbox.count()*t.vbox.volume())})}E.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,p=0;p<e.size();p++)if(e.peek(p).vbox.contains(t))return e.peek(p).color;return this.nearest(t)},nearest:function(t){for(var e=this.vboxes,p,y,m,v=0;v<e.size();v++)y=Math.sqrt(Math.pow(t[0]-e.peek(v).color[0],2)+Math.pow(t[1]-e.peek(v).color[1],2)+Math.pow(t[2]-e.peek(v).color[2],2)),(y<p||p===void 0)&&(p=y,m=e.peek(v).color);return m},forcebw:function(){var t=this.vboxes;t.sort(function(m,v){return q.naturalOrder(q.sum(m.color),q.sum(v.color))});var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var p=t.length-1,y=t[p].color;y[0]>251&&y[1]>251&&y[2]>251&&(t[p].color=[255,255,255])}};function z(M){var t=1<<3*s,e=new Array(t),p,y,m,v;return M.forEach(function(w){y=w[0]>>r,m=w[1]>>r,v=w[2]>>r,p=u(y,m,v),e[p]=(e[p]||0)+1}),e}function x(M,t){var e=1e6,p=0,y=1e6,m=0,v=1e6,w=0,C,l,$;return M.forEach(function(O){C=O[0]>>r,l=O[1]>>r,$=O[2]>>r,C<e?e=C:C>p&&(p=C),l<y?y=l:l>m&&(m=l),$<v?v=$:$>w&&(w=$)}),new _(e,p,y,m,v,w,t)}function F(M,t){if(!t.count())return;var e=t.r2-t.r1+1,p=t.g2-t.g1+1,y=t.b2-t.b1+1,m=q.max([e,p,y]);if(t.count()==1)return[t.copy()];var v=0,w=[],C=[],l,$,O,T,D;if(m==e)for(l=t.r1;l<=t.r2;l++){for(T=0,$=t.g1;$<=t.g2;$++)for(O=t.b1;O<=t.b2;O++)D=u(l,$,O),T+=M[D]||0;v+=T,w[l]=v}else if(m==p)for(l=t.g1;l<=t.g2;l++){for(T=0,$=t.r1;$<=t.r2;$++)for(O=t.b1;O<=t.b2;O++)D=u($,l,O),T+=M[D]||0;v+=T,w[l]=v}else for(l=t.b1;l<=t.b2;l++){for(T=0,$=t.r1;$<=t.r2;$++)for(O=t.g1;O<=t.g2;O++)D=u($,O,l),T+=M[D]||0;v+=T,w[l]=v}w.forEach(function(j,N){C[N]=v-j});function b(j){var N=j+"1",d=j+"2",a,n,h,o,c,g=0;for(l=t[N];l<=t[d];l++)if(w[l]>v/2){for(h=t.copy(),o=t.copy(),a=l-t[N],n=t[d]-l,a<=n?c=Math.min(t[d]-1,~~(l+n/2)):c=Math.max(t[N],~~(l-1-a/2));!w[c];)c++;for(g=C[c];!g&&w[c-1];)g=C[--c];return h[d]=c,o[N]=h[d]+1,[h,o]}}return m==e?b("r"):m==p?b("g"):b("b")}function L(M,t){if(!M.length||t<2||t>256)return!1;var e=z(M);e.forEach(function(){});var p=x(M,e),y=new S(function(C,l){return q.naturalOrder(C.count(),l.count())});y.push(p);function m(C,l){for(var $=C.size(),O=0,T;O<i;){if($>=l||O++>i)return;if(T=C.pop(),!T.count()){C.push(T),O++;continue}var D=F(e,T),b=D[0],j=D[1];if(!b)return;C.push(b),j&&(C.push(j),$++)}}m(y,f*t);for(var v=new S(function(C,l){return q.naturalOrder(C.count()*C.volume(),l.count()*l.volume())});y.size();)v.push(y.pop());m(v,t);for(var w=new E;v.size();)w.push(v.pop());return w}return{quantize:L}}(),vt=pt.quantize;function yt(s,r,i){const f=s,u=[];for(let S=0,_,E,z,x,F;S<r;S=S+i)_=S*4,E=f[_+0],z=f[_+1],x=f[_+2],F=f[_+3],(typeof F>"u"||F>=125)&&(E>250&&z>250&&x>250||u.push([E,z,x]));return u}function wt(s){let{colorCount:r,quality:i}=s;if(typeof r>"u"||!Number.isInteger(r))r=10;else{if(r===1)throw new Error("colorCount应该在2到20之间。要获得一种颜色, 调用getColor()而不是getPalette()");r=Math.max(r,2),r=Math.min(r,20)}return(typeof i>"u"||!Number.isInteger(i)||i<1)&&(i=10),{colorCount:r,quality:i}}const it={createPixelArray:yt,validateOptions:wt};function $t(s){s.setAttribute("crossOrigin","anonymous");const r=document.createElement("canvas"),i=r.getContext("2d"),f=r.width=s.width,u=r.height=s.height;return i.drawImage(s,0,0,f,u),{canvas:r,context:i,width:f,height:u,getImageData:()=>i.getImageData(0,0,f,u)}}function Mt(s,r=10){return G(s,5,r)[0]}function G(s,r=8,i=10){s.setAttribute("crossOrigin","anonymous");const f=it.validateOptions({colorCount:r,quality:i}),u=$t(s),S=u.getImageData(),_=u.width*u.height,E=it.createPixelArray(S.data,_,f.quality),z=vt(E,f.colorCount);return z?z.palette():[]}function bt(s,r){return new Promise((i,f)=>{const u=document.createElement("img");u.setAttribute("crossOrigin","anonymous"),u.addEventListener("load",()=>{const S=G(u,5,r),_=S?S[0]:[];i(_)}),u.addEventListener("error",()=>{f()}),u.src=s})}function St(s){return new Promise((r,i)=>{let f=new XMLHttpRequest;f.open("GET",s,!0),f.responseType="arraybuffer",f.onload=function(){if(this.status==200){let u=new Uint8Array(this.response),S=u.length,_=new Array(S);for(let x=0;x<u.length;x++)_[x]=String.fromCharCode(u[x]);let E=_.join(""),z=window.btoa(E);r("data:image/png;base64,"+z)}},f.onerror=i,f.send()})}const Dt={getPalette:G,getColorFromUrl:bt,getImageData:St,getColor:Mt};var Ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},X={},_t={get exports(){return X},set exports(s){X=s}};(function(s,r){(function(i,f){s.exports=f()})(Ot,function(){var i=1e3,f=6e4,u=36e5,S="millisecond",_="second",E="minute",z="hour",x="day",F="week",L="month",M="quarter",t="year",e="date",p="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(d){var a=["th","st","nd","rd"],n=d%100;return"["+d+(a[(n-20)%10]||a[n]||a[0])+"]"}},w=function(d,a,n){var h=String(d);return!h||h.length>=a?d:""+Array(a+1-h.length).join(n)+d},C={s:w,z:function(d){var a=-d.utcOffset(),n=Math.abs(a),h=Math.floor(n/60),o=n%60;return(a<=0?"+":"-")+w(h,2,"0")+":"+w(o,2,"0")},m:function d(a,n){if(a.date()<n.date())return-d(n,a);var h=12*(n.year()-a.year())+(n.month()-a.month()),o=a.clone().add(h,L),c=n-o<0,g=a.clone().add(h+(c?-1:1),L);return+(-(h+(n-o)/(c?o-g:g-o))||0)},a:function(d){return d<0?Math.ceil(d)||0:Math.floor(d)},p:function(d){return{M:L,y:t,w:F,d:x,D:e,h:z,m:E,s:_,ms:S,Q:M}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(d){return d===void 0}},l="en",$={};$[l]=v;var O=function(d){return d instanceof j},T=function d(a,n,h){var o;if(!a)return l;if(typeof a=="string"){var c=a.toLowerCase();$[c]&&(o=c),n&&($[c]=n,o=c);var g=a.split("-");if(!o&&g.length>1)return d(g[0])}else{var I=a.name;$[I]=a,o=I}return!h&&o&&(l=o),o||!h&&l},D=function(d,a){if(O(d))return d.clone();var n=typeof a=="object"?a:{};return n.date=d,n.args=arguments,new j(n)},b=C;b.l=T,b.i=O,b.w=function(d,a){return D(d,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var j=function(){function d(n){this.$L=T(n.locale,null,!0),this.parse(n)}var a=d.prototype;return a.parse=function(n){this.$d=function(h){var o=h.date,c=h.utc;if(o===null)return new Date(NaN);if(b.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var g=o.match(y);if(g){var I=g[2]-1||0,A=(g[7]||"0").substring(0,3);return c?new Date(Date.UTC(g[1],I,g[3]||1,g[4]||0,g[5]||0,g[6]||0,A)):new Date(g[1],I,g[3]||1,g[4]||0,g[5]||0,g[6]||0,A)}}return new Date(o)}(n),this.$x=n.x||{},this.init()},a.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},a.$utils=function(){return b},a.isValid=function(){return this.$d.toString()!==p},a.isSame=function(n,h){var o=D(n);return this.startOf(h)<=o&&o<=this.endOf(h)},a.isAfter=function(n,h){return D(n)<this.startOf(h)},a.isBefore=function(n,h){return this.endOf(h)<D(n)},a.$g=function(n,h,o){return b.u(n)?this[h]:this.set(o,n)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(n,h){var o=this,c=!!b.u(h)||h,g=b.p(n),I=function(B,H){var W=b.w(o.$u?Date.UTC(o.$y,H,B):new Date(o.$y,H,B),o);return c?W:W.endOf(x)},A=function(B,H){return b.w(o.toDate()[B].apply(o.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(H)),o)},Y=this.$W,k=this.$M,J=this.$D,U="set"+(this.$u?"UTC":"");switch(g){case t:return c?I(1,0):I(31,11);case L:return c?I(1,k):I(0,k+1);case F:var V=this.$locale().weekStart||0,Z=(Y<V?Y+7:Y)-V;return I(c?J-Z:J+(6-Z),k);case x:case e:return A(U+"Hours",0);case z:return A(U+"Minutes",1);case E:return A(U+"Seconds",2);case _:return A(U+"Milliseconds",3);default:return this.clone()}},a.endOf=function(n){return this.startOf(n,!1)},a.$set=function(n,h){var o,c=b.p(n),g="set"+(this.$u?"UTC":""),I=(o={},o[x]=g+"Date",o[e]=g+"Date",o[L]=g+"Month",o[t]=g+"FullYear",o[z]=g+"Hours",o[E]=g+"Minutes",o[_]=g+"Seconds",o[S]=g+"Milliseconds",o)[c],A=c===x?this.$D+(h-this.$W):h;if(c===L||c===t){var Y=this.clone().set(e,1);Y.$d[I](A),Y.init(),this.$d=Y.set(e,Math.min(this.$D,Y.daysInMonth())).$d}else I&&this.$d[I](A);return this.init(),this},a.set=function(n,h){return this.clone().$set(n,h)},a.get=function(n){return this[b.p(n)]()},a.add=function(n,h){var o,c=this;n=Number(n);var g=b.p(h),I=function(k){var J=D(c);return b.w(J.date(J.date()+Math.round(k*n)),c)};if(g===L)return this.set(L,this.$M+n);if(g===t)return this.set(t,this.$y+n);if(g===x)return I(1);if(g===F)return I(7);var A=(o={},o[E]=f,o[z]=u,o[_]=i,o)[g]||1,Y=this.$d.getTime()+n*A;return b.w(Y,this)},a.subtract=function(n,h){return this.add(-1*n,h)},a.format=function(n){var h=this,o=this.$locale();if(!this.isValid())return o.invalidDate||p;var c=n||"YYYY-MM-DDTHH:mm:ssZ",g=b.z(this),I=this.$H,A=this.$m,Y=this.$M,k=o.weekdays,J=o.months,U=function(H,W,tt,Q){return H&&(H[W]||H(h,c))||tt[W].slice(0,Q)},V=function(H){return b.s(I%12||12,H,"0")},Z=o.meridiem||function(H,W,tt){var Q=H<12?"AM":"PM";return tt?Q.toLowerCase():Q},B={YY:String(this.$y).slice(-2),YYYY:this.$y,M:Y+1,MM:b.s(Y+1,2,"0"),MMM:U(o.monthsShort,Y,J,3),MMMM:U(J,Y),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:U(o.weekdaysMin,this.$W,k,2),ddd:U(o.weekdaysShort,this.$W,k,3),dddd:k[this.$W],H:String(I),HH:b.s(I,2,"0"),h:V(1),hh:V(2),a:Z(I,A,!0),A:Z(I,A,!1),m:String(A),mm:b.s(A,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:g};return c.replace(m,function(H,W){return W||B[H]||g.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(n,h,o){var c,g=b.p(h),I=D(n),A=(I.utcOffset()-this.utcOffset())*f,Y=this-I,k=b.m(this,I);return k=(c={},c[t]=k/12,c[L]=k,c[M]=k/3,c[F]=(Y-A)/6048e5,c[x]=(Y-A)/864e5,c[z]=Y/u,c[E]=Y/f,c[_]=Y/i,c)[g]||Y,o?k:b.a(k)},a.daysInMonth=function(){return this.endOf(L).$D},a.$locale=function(){return $[this.$L]},a.locale=function(n,h){if(!n)return this.$L;var o=this.clone(),c=T(n,h,!0);return c&&(o.$L=c),o},a.clone=function(){return b.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},d}(),N=j.prototype;return D.prototype=N,[["$ms",S],["$s",_],["$m",E],["$H",z],["$W",x],["$M",L],["$y",t],["$D",e]].forEach(function(d){N[d[1]]=function(a){return this.$g(a,d[0],d[1])}}),D.extend=function(d,a){return d.$i||(d(a,j,D),d.$i=!0),D},D.locale=T,D.isDayjs=O,D.unix=function(d){return D(1e3*d)},D.en=$[l],D.Ls=$,D.p={},D})})(_t);const K=X;function Ct(s,r="YYYY-MM-DD"){const i=new Date(s.getFullYear(),s.getMonth()+1,0);return K(i).format(r)}function It(s,r="YYYY-MM-DD"){const i=new Date(s.getFullYear(),s.getMonth(),1);return K(i).format(r)}const Tt=Object.freeze(Object.defineProperty({__proto__:null,firstDayOfMonth:It,lastDayOfMonth:Ct},Symbol.toStringTag,{value:"Module"}));P.ColorThief=Dt,P.date=Tt,P.dayjs=K,P.downloadFile=gt,P.downloadImg=mt,P.isObject=ct,P.localStorage=ft,P.sessionStorage=lt,P.waterMark=ht,P.withInstall=R,Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})});
